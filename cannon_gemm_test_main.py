import numpy as np
import arch_lib
from GEMM.arch import top_level_gemm


gemm_sizes = [(90*200,90*200,90*200),
              (90*200*2,90*200*2,90*200*2),
              (90*200*4,90*200*4,90*200*4),
              (90*200*8,90*200*8,90*200*8),
              (90*200*16,90*200*16,90*200*16),
              (90*200*32,90*200*32,90*200*32),
              (90*200*64,90*200*64,90*200*64),
              ]

gemm_sizes = [
    (819200, 819200, 819200),
    (409600, 409600, 409600),
    (204800, 204800, 204800),
    (102400, 102400, 102400),
    (51200, 51200, 51200),
    (25600, 25600, 25600),
    (12800, 12800, 12800),
    (6400, 6400, 6400),
    (3200, 3200, 3200),
    (1600, 1600, 1600),
    (800, 800, 800)
]
# m,k,n = (1800*2,1800*2,1800*2)
# m,k,n = (37800.0, 37800.0, 37800.0)
# m,k,n = (900, 900, 900)
for m,k,n in gemm_sizes:
    top_level_gemm(m,k,n, arch_lib.node_cmos_3x3leaf, debug=True, general_tiling=True)

